#!/usr/bin/env php
<?php

//this autoloads classes from "vendor" dir if vendor dir exists
$vendor_autoload = __DIR__ . '/../vendor/autoload.php';
if (is_readable($vendor_autoload)) {
  require_once($vendor_autoload);
}

//this autoloads classes from current folder
spl_autoload_register(function ($class) {
  $file = preg_replace('#\\\#', '/', $class) . '.php';
  if (stream_resolve_include_path($file))
    require $file;
});

ob_implicit_flush(true);
error_reporting(E_ALL & ~E_NOTICE);

echo getcwd();

array_shift($argv);

$class_to_run = array_shift($argv);

if (class_exists("Runners\\" . $class_to_run)) {
  $runnerClass = "Runners\\" . $class_to_run;
  $runner = new $runnerClass;
  if ($argv[0] && $argv[0] == 'help') {
    $runner->help();
  } else {
    $runner->run($argv);
  }
}
